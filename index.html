<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ”¾é€åŸç¨¿ ç·¨é›†ãƒ»çµ±åˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼</title>
    <!-- Tailwind CSSã®èª­ã¿è¾¼ã¿ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªåŸºæœ¬è¨­å®š */
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #f3f4f6;
        }
        /* å°åˆ·æ™‚ã®è¨­å®šï¼ˆå¿…è¦ã§ã‚ã‚Œã°ï¼‰ */
        @media print {
            .no-print {
                display: none;
            }
        }
        /* ãƒã‚¹ã‚¯æ©Ÿèƒ½ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .mask-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
            border-radius: inherit;
            pointer-events: none;
            text-align: center;
        }
        /* èª­ã¿ä¸Šã’æ©Ÿèƒ½ãŒä½¿ã„ã‚„ã™ã„ã‚ˆã†ã«ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ˜ç¢ºã«å›²ã‚€ */
        .masked-content {
            position: relative; 
            display: block; 
            border-radius: 0.375rem; 
            border: 1px dashed transparent; 
            padding: 8px;
            transition: border-color 0.2s;
        }
        /* iPadãªã©ã®èª­ã¿ä¸Šã’æ©Ÿèƒ½ã§é¸æŠã—ã‚„ã™ã„ã‚ˆã†ã€ãƒ›ãƒãƒ¼ã§å¢ƒç•Œç·šã‚’å¼·èª¿ */
        .masked-content:hover {
            border-color: #3b82f6;
        }
        .script-box {
            position: relative;
        }
        /* ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã‚’éè¡¨ç¤ºã«ã™ã‚‹åˆæœŸè¨­å®š */
        #data-editor-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out;
        }
        #data-editor-container.open {
            max-height: 3000px; /* ååˆ†ãªé«˜ã•ã‚’ç¢ºä¿ */
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-6xl mx-auto bg-white shadow-2xl rounded-xl min-h-[90vh]">
        <header class="p-6 bg-blue-700 text-white rounded-t-xl">
            <h1 class="text-3xl font-extrabold text-center">
                å®ä»™å° ãƒ©ã‚¸ã‚ªæ”¾é€åŸç¨¿ ç·¨é›†ãƒ»çµ±åˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
            </h1>
            <p class="text-center mt-1 opacity-80">ç”»é¢ä¸Šã§ãƒ‡ãƒ¼ã‚¿ã‚’ç·¨é›†ãƒ»è¿½åŠ ã—ã€æœ€æ–°ç‰ˆã®HTMLã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚</p>
        </header>

        <!-- ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ: æ—¥ä»˜é¸æŠ (å·¦) ã¨ è©³ç´°è¡¨ç¤º (å³) -->
        <div class="flex flex-col lg:flex-row">
            
            <!-- 1. æ—¥ä»˜é¸æŠã‚µã‚¤ãƒ‰ãƒãƒ¼ (ãƒªã‚¹ãƒˆ) -->
            <div id="date-selector" class="w-full lg:w-1/4 p-4 lg:p-6 bg-gray-50 border-r border-gray-200 no-print">
                <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2">ğŸ—“ï¸ æ”¾é€æ—¥ã‚’é¸æŠ</h2>
                
                <!-- ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ -->
                <button id="toggle-editor-button" 
                        class="w-full text-center p-3 my-2 rounded-lg transition duration-150 ease-in-out bg-purple-500 hover:bg-purple-600 text-white font-bold shadow-lg no-print flex items-center justify-center">
                    <span id="editor-status">â• æ–°è¦ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ </span>
                </button>

                <!-- ã€å…¨é¢æ”¹è‰¯ã€‘ãƒ‡ãƒ¼ã‚¿ç·¨é›†/è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ãƒŠ -->
                <div id="data-editor-container" class="bg-white p-0 rounded-lg shadow-inner mt-2 border border-purple-200">
                    <div class="p-4">
                        <h3 id="editor-title" class="text-lg font-bold text-purple-700 mb-3">æ–°è¦æ”¾é€ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</h3>
                        
                        <input type="hidden" id="input-id">

                        <label class="block mb-2"><span class="text-sm font-medium">æ—¥ä»˜ (ä¾‹: 1æœˆ20æ—¥ (é‡‘)):</span>
                            <input type="text" id="input-date" class="w-full p-2 border rounded" placeholder="ä¾‹: 2æœˆ10æ—¥ (é‡‘)">
                        </label>
                        <label class="block mb-2"><span class="text-sm font-medium">æ”¾é€ç•ªå·:</span>
                            <input type="number" id="input-broadcast-no" class="w-full p-2 border rounded" placeholder="ä¾‹: 4">
                        </label>
                        
                        <!-- æœã®æ”¾é€ç·¨é›†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ -->
                        <h4 class="font-bold mt-4 mb-1 text-orange-700 border-t pt-2">â˜€ï¸ æœã®æ”¾é€è¨­å®š</h4>
                        <label class="block mb-2"><span class="text-sm font-medium">æ›²ç›® (æœ):</span>
                            <input type="text" id="input-morning-music" class="w-full p-2 border rounded" placeholder="ä¾‹: 1æ›²ç›®ï¼šã‚¸ãƒ–ãƒª (æ›²åæœªå®š)">
                        </label>
                        <label class="block mb-2"><span class="text-sm font-medium">ã‚³ãƒ¼ãƒŠãƒ¼å (æœ):</span>
                            <input type="text" id="input-morning-corner" class="w-full p-2 border rounded" placeholder="ä¾‹: åå–„æˆ’ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«">
                        </label>

                        <!-- æ˜¼ã®æ”¾é€ç·¨é›†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ -->
                        <h4 class="font-bold mt-4 mb-1 text-blue-700 border-t pt-2">ğŸœ æ˜¼ã®æ”¾é€è¨­å®š</h4>
                        <label class="block mb-2"><span class="text-sm font-medium">å°å…¥ã‚»ãƒªãƒ• (ã‚¤ãƒ³ãƒˆãƒ­):</span>
                            <textarea id="input-intro" class="w-full p-2 border rounded h-16" placeholder="ä¾‹: å…¨ãƒ»å®ä»™å°ã®çš†ã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼..."></textarea>
                        </label>
                        <label class="block mb-2"><span class="text-sm font-medium">æ›²ç›® (æ˜¼ / å„æ›²ã‚’ã€Œ|ã€ã§åŒºåˆ‡ã‚‹):</span>
                            <input type="text" id="input-music" class="w-full p-2 border rounded" placeholder="ä¾‹: 1æ›²ç›®ï¼šã€‡ã€‡|2æ›²ç›®ï¼šâœ•âœ•|3æ›²ç›®ï¼šâ–³â–³">
                            <p class="text-xs text-gray-500 mt-1">â€»3æ›²ç›®ä»¥é™ã‚‚ã€Œ|ã€ã§åŒºåˆ‡ã£ã¦è¿½è¨˜ã§ãã¾ã™ã€‚</p>
                        </label>
                        <label class="block mb-2"><span class="text-sm font-medium">é›‘å­¦ã‚¿ã‚¤ãƒˆãƒ«:</span>
                            <input type="text" id="input-trivia-title" class="w-full p-2 border rounded" placeholder="ä¾‹: ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ é›‘å­¦ï¼šä¸–ç•Œã®ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³">
                        </label>
                        <label class="block mb-2"><span class="text-sm font-medium">é›‘å­¦å†…å®¹ (ãƒ¡ã‚¤ãƒ³ã®é›‘å­¦1ã¤åˆ†):</span>
                            <textarea id="input-trivia-content" class="w-full p-2 border rounded h-24" placeholder="ä¾‹: ãƒ•ãƒ©ãƒ³ã‚¹ã§ã¯ã€çµ¦é£Ÿã®æ™‚é–“ãŒç´„1æ™‚é–“åŠã¨é•·ã...ï¼ˆé›‘å­¦ä¸€ã¤åˆ†ã®å†…å®¹ã‚’å…¥åŠ›ï¼‰"></textarea>
                        </label>
                        <label class="block mb-2"><span class="text-sm font-medium">ç· ã‚ã®ã‚»ãƒªãƒ• (ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ³ã‚°):</span>
                            <textarea id="input-closing" class="w-full p-2 border rounded h-16" placeholder="ä¾‹: ã‚‚ã†ã€æ˜¼ä¼‘ã¿ã®ãŠæ™‚é–“ãŒãã¦ã—ã¾ã„ã¾ã—ãŸã€‚..."></textarea>
                        </label>

                        <button id="add-data-button" class="w-full p-3 mt-4 rounded-lg bg-red-500 hover:bg-red-600 text-white font-bold transition">
                            ãƒ‡ãƒ¼ã‚¿ã«è¿½åŠ ï¼†æ›´æ–°
                        </button>
                    </div>
                    
                </div>
                
                <!-- è©³ç´°è¡¨ç¤ºã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³ -->
                <button id="clear-selection-button" 
                        class="w-full text-center p-3 my-2 rounded-lg transition duration-150 ease-in-out bg-gray-200 hover:bg-gray-300 border border-gray-300 shadow-sm font-bold text-gray-700 no-print">
                    è©³ç´°è¡¨ç¤ºã‚’ã‚¯ãƒªã‚¢
                </button>

                <!-- ã€é‡è¦ã€‘ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ -->
                <button id="download-button" 
                        class="w-full text-center p-3 mt-4 rounded-lg transition duration-150 ease-in-out bg-green-500 hover:bg-green-600 text-white font-bold shadow-xl no-print">
                    ğŸ’¾ æœ€æ–°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                </button>
                
                <!-- æ—¥ä»˜ãƒœã‚¿ãƒ³ãŒã“ã“ã«JSã§æŒ¿å…¥ã•ã‚Œã‚‹ -->
            </div>

            <!-- 2. è©³ç´°è¡¨ç¤ºã‚¨ãƒªã‚¢ (å¤§ç”»é¢) -->
            <div id="script-detail" class="w-full lg:w-3/4 p-6 lg:p-10 relative">
                <!-- ãƒã‚¹ã‚¯ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ (STATIC) -->
                <div id="mask-controls" class="mb-4 text-right no-print hidden">
                    <button id="mask-button" 
                            class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg shadow transition duration-150 ease-in-out">
                        ğŸ”’ å†…å®¹ã‚’éš ã™ (ãƒã‚¹ã‚¯ON)
                    </button>
                </div>

                <p id="initial-message" class="text-center text-gray-500 mt-20 text-lg">
                    å·¦å´ã®ãƒªã‚¹ãƒˆã‹ã‚‰æ”¾é€æ—¥ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
                </p>
                <!-- é¸æŠã•ã‚ŒãŸåŸç¨¿ã®å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯ã“ã“ã«è¿½åŠ ã•ã‚Œã‚‹ -->
            </div>
        </div>

    </div>

<script>
    // ----------------------------------------------------
    // 1. æ”¾é€ãƒ‡ãƒ¼ã‚¿ï¼ˆåˆæœŸãƒ‡ãƒ¼ã‚¿ã¨ç·¨é›†ç”¨ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
    // ----------------------------------------------------

    // åˆæœŸãƒ‡ãƒ¼ã‚¿ (ã“ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã™)
    // ã€é‡è¦ã€‘æ–°ã—ã„æ”¾é€æ—¥ã‚’è¿½åŠ ã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®ãƒªã‚¹ãƒˆã®æœ€å¾Œã« {} ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
    const initialBroadcastData = [
        {
            id: 1, // ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªID (æ•°å­—)
            date: "12æœˆ1æ—¥ (æœˆ)", // UIã«è¡¨ç¤ºã•ã‚Œã‚‹æ—¥ä»˜
            broadcastNo: 1, // æ”¾é€ç•ªå·
            morning: { title: "æœã®æ”¾é€", music: "1æ›²ç›®ï¼šã‚¸ãƒ–ãƒª (æ›²åæœªå®š)", corner: "åå–„æˆ’ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«" },
            lunch: {
                title: "æ˜¼ã®æ”¾é€",
                music: ["1æ›²ç›®ï¼šã‚­ã‚»ã‚­ (GReeeeN)", "2æ›²ç›®ï¼šã“ãŸãˆã‚ã‚ã› (back number)", "3æ›²ç›®ï¼šæ€ªç£ã®èŠ±å”„ (Vaundy)"],
                intro: "å…¨ãƒ»å®ä»™å°ã®çš†ã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼ã•ã¦ã€å§‹ã¾ã‚Šã¾ã—ãŸï¼ã€ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯ã€ã®ãŠæ™‚é–“ã§ã™ï¼ã“ã®ç•ªçµ„ã¯ã€çš†ã•ã‚“ã®æ¯æ—¥ãŒã•ã‚‰ã«æ¥½ã—ããªã‚‹ã‚ˆã†ã«ç™ºä¿¡ã™ã‚‹å®ä»™å°ãƒ©ã‚¸ã‚ªç•ªçµ„ã§ã™ã€‚",
                triviaTitle: "ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ é›‘å­¦ï¼šä¸–ç•Œã®çµ¦é£Ÿãƒ»ãƒ©ãƒ³ãƒäº‹æƒ…",
                triviaContent: [ 
                    { title: "ãƒ•ãƒ©ãƒ³ã‚¹", text: "ãƒ•ãƒ©ãƒ³ã‚¹ã§ã¯ã€çµ¦é£Ÿã®æ™‚é–“ãŒç´„1æ™‚é–“åŠã¨é•·ãã€ã‚³ãƒ¼ã‚¹æ–™ç†ã®ã‚ˆã†ã«å‰èœã‹ã‚‰ãƒ‡ã‚¶ãƒ¼ãƒˆã¾ã§ã‚†ã£ãã‚Šã¨é£Ÿã¹ã¾ã™ã€‚é£Ÿè‚²ã‚’å¤§åˆ‡ã«ã—ã¦ã„ã¦ã€çµ¦é£Ÿã®æ™‚é–“ã‚‚æˆæ¥­ã®ä¸€ç’°ã¨è€ƒãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚" },
                    { title: "ã‚¤ãƒ³ãƒ‰", text: "ã‚¤ãƒ³ãƒ‰ã®çµ¦é£Ÿã¯ã€å¤šãã®å ´åˆã€Œãƒ™ã‚¸ã‚¿ãƒªã‚¢ãƒ³ï¼ˆé‡èœã ã‘ï¼‰ã€ã®çŒ®ç«‹ã§ã™ã€‚ã‚«ãƒ¬ãƒ¼ãƒ©ã‚¤ã‚¹ã§ã¯ãªãã€è‰²ã€…ãªç¨®é¡ã®è±†ã®ã‚«ãƒ¬ãƒ¼ã‚„é‡èœã®ç‚’ã‚ç‰©ãŒå‡ºã¾ã™ã€‚ãã—ã¦ã€ã‚¤ãƒ³ãƒ‰ã§ã¯ã‚«ãƒˆãƒ©ãƒªãƒ¼ï¼ˆã‚¹ãƒ—ãƒ¼ãƒ³ã‚„ãŠç®¸ï¼‰ã‚’ä½¿ã‚ãšã€å³æ‰‹ã ã‘ã‚’ä½¿ã£ã¦é£Ÿã¹ã‚‹ã®ãŒä¸€èˆ¬çš„ã§ã™ã€‚" },
                    { title: "ãƒ–ãƒ©ã‚¸ãƒ«", text: "ãƒ–ãƒ©ã‚¸ãƒ«ã§ã¯ã€çµ¦é£Ÿã¯ç”Ÿå¾’ã®ä½“æ ¼ã‚„æ „é¤ŠçŠ¶æ…‹ã«åˆã‚ã›ã¦æä¾›ã•ã‚Œã¾ã™ã€‚ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å¯¾å¿œã‚„ã€å®—æ•™çš„ãªé£Ÿäº‹åˆ¶é™ã«ã‚‚æŸ”è»Ÿã«å¯¾å¿œã—ã¦ã„ã‚‹ã®ãŒç‰¹å¾´ã§ã™ã€‚" }
                ],
                closing: "ã‚‚ã†ã€æ˜¼ä¼‘ã¿ã®ãŠæ™‚é–“ãŒãã¦ã—ã¾ã„ã¾ã—ãŸã€‚ãŠæ¥½ã—ã¿ã„ãŸã ã‘ã¾ã—ãŸã‹ï¼Ÿãã‚Œã§ã¯ã€ä»Šæ—¥ã¯ã“ã®ã¸ã‚“ã§ã€‚ä»Šæ—¥ã®æ”¾é€ã®æ‹…å½“ã¯**ï¼ˆè‡ªåˆ†ã®åå‰ï¼‰**ã¨**ã€‡ã€‡**ã§ã—ãŸï¼ã¾ãŸæ˜æ—¥ã‚‚ãŠä¼šã„ã—ã¾ã—ã‚‡ã†ï¼ã•ã‚ˆã†ãªã‚‰ï¼"
            }
        },
        {
            id: 2,
            date: "12æœˆ15æ—¥ (ç«)",
            broadcastNo: 2,
            morning: { title: "æœã®æ”¾é€", music: "1æ›²ç›®ï¼šã‚¸ãƒ–ãƒª (æ›²åæœªå®š)", corner: "åå–„æˆ’ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«" },
            lunch: {
                title: "æ˜¼ã®æ”¾é€",
                music: ["1æ›²ç›®ï¼šæ°´å¹³ç·š (back number)", "2æ›²ç›®ï¼šã‚¨ã‚¸ã‚½ãƒ³ (æ°´æ›œæ—¥ã®ã‚«ãƒ³ãƒ‘ãƒãƒ©)", "3æ›²ç›®ï¼šãƒ‘ãƒ—ãƒªã‚« (Foorin)"],
                intro: "å…¨ãƒ»å®ä»™å°ã®çš†ã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼ã•ã¦ã€å§‹ã¾ã‚Šã¾ã—ãŸï¼ã€ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯ã€ã®ãŠæ™‚é–“ã§ã™ï¼ã“ã®ç•ªçµ„ã¯ã€çš†ã•ã‚“ã®æ¯æ—¥ãŒã•ã‚‰ã«æ¥½ã—ããªã‚‹ã‚ˆã†ã«ç™ºä¿¡ã™ã‚‹å®ä»™å°ãƒ©ã‚¸ã‚ªç•ªçµ„ã§ã™ã€‚",
                triviaTitle: "ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ é›‘å­¦ï¼šä¸–ç•Œã®ã‚¯ãƒªã‚¹ãƒã‚¹",
                triviaContent: [
                    { title: "ãƒ‰ã‚¤ãƒ„", text: "ã‚¯ãƒªã‚¹ãƒã‚¹ã®ç´„4é€±é–“å‰ã‹ã‚‰ã€Œã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã€ã¨ã„ã†æœŸé–“ã«å…¥ã‚Šã¾ã™ã€‚ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¯ãƒ‰ã‚¤ãƒ„ç™ºç¥¥ã§ã™ã€‚" },
                    { title: "ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢", text: "å—åŠçƒã§çœŸå¤ãªã®ã§ã€ã‚µãƒ³ã‚¿ã•ã‚“ã¯ã‚«ãƒ³ã‚¬ãƒ«ãƒ¼ã‚„ã‚µãƒ¼ãƒ•ãƒœãƒ¼ãƒ‰ã«ä¹—ã£ã¦ãã‚‹ã¨è¨€ã‚ã‚Œã¦ã„ã¾ã™ã€‚ãƒ“ãƒ¼ãƒã‚„åº­ã§ãƒãƒ¼ãƒ™ã‚­ãƒ¥ãƒ¼ã‚’ã—ã¾ã™ã€‚" },
                    { title: "æ—¥æœ¬", text: "ã‚¯ãƒªã‚¹ãƒã‚¹ã«ãƒ•ãƒ©ã‚¤ãƒ‰ãƒã‚­ãƒ³ã‚’é£Ÿã¹ã‚‹ç¿’æ…£ãŒã‚ã‚‹ã®ã¯ã€ä¸–ç•Œã§ã‚‚çã—ã„æ—¥æœ¬ã®æ–‡åŒ–ã ã¨è¨€ã‚ã‚Œã¦ã„ã¾ã™ã€‚" }
                ],
                closing: "ã‚‚ã†ã€æ˜¼ä¼‘ã¿ã®ãŠæ™‚é–“ãŒãã¦ã—ã¾ã„ã¾ã—ãŸã€‚ãŠæ¥½ã—ã¿ã„ãŸã ã‘ã¾ã—ãŸã‹ï¼Ÿãã‚Œã§ã¯ã€ä»Šæ—¥ã¯ã“ã®ã¸ã‚“ã§ã€‚ä»Šæ—¥ã®æ”¾é€ã®æ‹…å½“ã¯**ï¼ˆè‡ªåˆ†ã®åå‰ï¼‰**ã¨**ã€‡ã€‡**ã§ã—ãŸï¼ã¾ãŸæ˜æ—¥ã‚‚ãŠä¼šã„ã—ã¾ã—ã‚‡ã†ï¼ã•ã‚ˆã†ãªã‚‰ï¼"
            }
        },
        {
            id: 3,
            date: "1æœˆXXæ—¥ (æ°´)",
            broadcastNo: 3,
            morning: { title: "æœã®æ”¾é€", music: "1æ›²ç›®ï¼šã‚¸ãƒ–ãƒª (æ›²åæœªå®š)", corner: "åå–„æˆ’ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«" },
            lunch: {
                title: "æ˜¼ã®æ”¾é€",
                music: ["å®¶ã‚«ãƒ•ã‚§CDã‚ˆã‚Š3æ›²ï¼ˆæ›²åæœªå®šï¼‰"],
                intro: "å…¨ãƒ»å®ä»™å°ã®çš†ã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼ã•ã¦ã€å§‹ã¾ã‚Šã¾ã—ãŸï¼ã€ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯ã€ã®ãŠæ™‚é–“ã§ã™ï¼ã“ã®ç•ªçµ„ã¯ã€çš†ã•ã‚“ã®æ¯æ—¥ãŒã•ã‚‰ã«æ¥½ã—ããªã‚‹ã‚ˆã†ã«ç™ºä¿¡ã™ã‚‹å®ä»™å°ãƒ©ã‚¸ã‚ªç•ªçµ„ã§ã™ã€‚",
                triviaTitle: "ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ é›‘å­¦ï¼šãŠæ­£æœˆã®éŠã³",
                triviaContent: [
                    { title: "å‡§æšã’", text: "å‡§æšã’ã¯ã‚‚ã¨ã‚‚ã¨ã€å­ã©ã‚‚ã®æˆé•·ã‚’é¡˜ã£ã¦å¤§äººãŒã‚„ã£ã¦ã„ãŸè¡Œäº‹ã§ã™ã€‚æ±Ÿæˆ¸æ™‚ä»£ã«å¤§äººæ°—ã«ãªã‚Šã¾ã—ãŸãŒã€äººãŒã¶ã¤ã‹ã£ãŸã‚Šç«äº‹ã«ãªã£ãŸã‚Šã—ã¦ã€ä¸€æ™‚ç¦æ­¢ã•ã‚ŒãŸã“ã¨ã‚‚ã‚ã£ãŸãã†ã§ã™ã€‚" },
                    { title: "ç¾½æ ¹ã¤ã", text: "ç¾½æ ¹ã¤ãã§ä½¿ã†ç¾½æ ¹ï¼ˆã‚€ãã‚ã˜ï¼‰ã«ã¯ã€è™«ã‚’é£Ÿã¹ã‚‹é»’ã„è±†ï¼ˆãƒ ã‚¯ãƒ­ã‚¸ã®ç¨®ï¼‰ãŒä»˜ã„ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ç¾½æ ¹ã¤ãã‚’ã™ã‚‹ã“ã¨ã§ã€å„ã‚’æ‰•ã„ã€èšŠãªã©ã®å®³è™«ã‚’è¿½ã„æ‰•ã†é­”é™¤ã‘ã®æ„å‘³ãŒã‚ã£ãŸã¨è¨€ã‚ã‚Œã¦ã„ã¾ã™ã€‚" }
                ],
                closing: "ã‚‚ã†ã€æ˜¼ä¼‘ã¿ã®ãŠæ™‚é–“ãŒãã¦ã—ã¾ã„ã¾ã—ãŸã€‚ãŠæ¥½ã—ã¿ã„ãŸã ã‘ã¾ã—ãŸã‹ï¼Ÿãã‚Œã§ã¯ã€ä»Šæ—¥ã¯ã“ã®ã¸ã‚“ã§ã€‚ä»Šæ—¥ã®æ”¾é€ã®æ‹…å½“ã¯**ï¼ˆè‡ªåˆ†ã®åå‰ï¼‰**ã¨**ã€‡ã€‡**ã§ã—ãŸï¼ã¾ãŸæ˜æ—¥ã‚‚ãŠä¼šã„ã—ã¾ã—ã‚‡ã†ï¼ã•ã‚ˆã†ãªã‚‰ï¼"
            }
        },
    ];
    
    // ç¾åœ¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¼ã‚¿ï¼ˆlocalStorageã‹ã‚‰ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‹ã€åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰
    let currentBroadcastData = [];

    const LOCAL_STORAGE_KEY = 'hosen_broadcast_data';

    // 2. localStorageã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
    function loadData() {
        try {
            const storedData = localStorage.getItem(LOCAL_STORAGE_KEY);
            if (storedData) {
                currentBroadcastData = JSON.parse(storedData);
            } else {
                currentBroadcastData = initialBroadcastData;
                saveData();
            }
        } catch (e) {
            console.error("Failed to load data from localStorage, using initial data.", e);
            currentBroadcastData = initialBroadcastData;
        }
    }

    // 3. ãƒ‡ãƒ¼ã‚¿ã‚’localStorageã«ä¿å­˜ã™ã‚‹
    function saveData() {
        try {
            localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(currentBroadcastData));
        } catch (e) {
            console.error("Failed to save data to localStorage.", e);
        }
    }


    // ----------------------------------------------------
    // 4. UIè¦ç´ ã®å–å¾—
    // ----------------------------------------------------
    const selector = document.getElementById('date-selector');
    const detailArea = document.getElementById('script-detail');
    const initialMessage = document.getElementById('initial-message');
    const maskControls = document.getElementById('mask-controls');
    const maskButton = document.getElementById('mask-button');
    const clearButton = document.getElementById('clear-selection-button'); 
    const downloadButton = document.getElementById('download-button');
    const toggleEditorButton = document.getElementById('toggle-editor-button');
    const dataEditorContainer = document.getElementById('data-editor-container');
    const editorTitle = document.getElementById('editor-title');
    const addDataButton = document.getElementById('add-data-button');
    const editorStatus = document.getElementById('editor-status');
    
    // ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã®å–å¾—
    const inputId = document.getElementById('input-id');
    const inputDate = document.getElementById('input-date');
    const inputBroadcastNo = document.getElementById('input-broadcast-no');
    const inputMorningMusic = document.getElementById('input-morning-music');
    const inputMorningCorner = document.getElementById('input-morning-corner');
    const inputIntro = document.getElementById('input-intro');
    const inputMusic = document.getElementById('input-music');
    const inputTriviaTitle = document.getElementById('input-trivia-title');
    const inputTriviaContent = document.getElementById('input-trivia-content');
    const inputClosing = document.getElementById('input-closing');

    let isMasked = false;
    let isEditorOpen = false;
    let currentEditId = null; // ç¾åœ¨ç·¨é›†ä¸­ã®ãƒ‡ãƒ¼ã‚¿ã®ID

    // ----------------------------------------------------
    // 5. ãƒ‡ãƒ¼ã‚¿ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒˆã‚°ãƒ«ã¨åˆæœŸåŒ–
    // ----------------------------------------------------
    toggleEditorButton.addEventListener('click', () => {
        if (!isEditorOpen) {
            // ã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ãã¨ãã¯ã€å¿…ãšæ–°è¦è¿½åŠ ãƒ¢ãƒ¼ãƒ‰ã§åˆæœŸåŒ–
            resetEditorForm();
            openEditor();
        } else {
            closeEditor();
        }
    });

    function openEditor(mode = 'add', data = null) {
        dataEditorContainer.classList.add('open');
        isEditorOpen = true;
        
        if (mode === 'edit' && data) {
            currentEditId = data.id;
            editorTitle.textContent = `å¤‰æ›´ã‚’ç·¨é›† (ID: ${data.id}, æ”¾é€ç•ªå·: ${data.broadcastNo})`;
            addDataButton.textContent = 'âœ… ã“ã®å¤‰æ›´ã‚’ä¿å­˜';
            addDataButton.classList.replace('bg-red-500', 'bg-green-600');
            addDataButton.classList.replace('hover:bg-red-600', 'hover:bg-green-700');
            
            // ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰
            inputDate.value = data.date;
            inputBroadcastNo.value = data.broadcastNo;
            inputId.value = data.id;

            // æœã®æ”¾é€
            inputMorningMusic.value = data.morning.music || '';
            inputMorningCorner.value = data.morning.corner || '';

            // æ˜¼ã®æ”¾é€
            inputIntro.value = data.lunch.intro || '';
            // éŸ³æ¥½é…åˆ—ã‚’ã€Œ|ã€åŒºåˆ‡ã‚Šã®æ–‡å­—åˆ—ã«æˆ»ã™
            inputMusic.value = data.lunch.music.join('|');
            inputTriviaTitle.value = data.lunch.triviaTitle || '';
            // é›‘å­¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æœ€åˆã®é …ç›®ã®ã¿ã‚’ç·¨é›†å¯¾è±¡ã¨ã™ã‚‹ (UIç°¡ç•¥åŒ–ã®ãŸã‚)
            inputTriviaContent.value = data.lunch.triviaContent[0]?.text || '';
            inputClosing.value = data.lunch.closing || '';
            
            editorStatus.innerHTML = 'âŒ ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‰ã˜ã‚‹';
            toggleEditorButton.classList.replace('bg-purple-500', 'bg-red-500');
            toggleEditorButton.classList.replace('hover:bg-purple-600', 'hover:bg-red-600');

        } else {
            // æ–°è¦è¿½åŠ ãƒ¢ãƒ¼ãƒ‰
            resetEditorForm();
            editorStatus.innerHTML = 'âŒ ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‰ã˜ã‚‹';
            toggleEditorButton.classList.replace('bg-purple-500', 'bg-red-500');
            toggleEditorButton.classList.replace('hover:bg-purple-600', 'hover:bg-red-600');
        }
    }

    function closeEditor() {
        dataEditorContainer.classList.remove('open');
        isEditorOpen = false;
        editorStatus.innerHTML = 'â• æ–°è¦ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ';
        toggleEditorButton.classList.replace('bg-red-500', 'bg-purple-500');
        toggleEditorButton.classList.replace('hover:bg-red-600', 'hover:bg-purple-600');
        resetEditorForm();
    }
    
    function resetEditorForm() {
        currentEditId = null;
        editorTitle.textContent = 'æ–°è¦æ”¾é€ãƒ‡ãƒ¼ã‚¿å…¥åŠ›';
        addDataButton.textContent = 'ãƒ‡ãƒ¼ã‚¿ã«è¿½åŠ ï¼†æ›´æ–°';
        addDataButton.classList.replace('bg-green-600', 'bg-red-500');
        addDataButton.classList.replace('hover:bg-green-700', 'hover:bg-red-600');
        
        // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ç©ºã«ã™ã‚‹
        document.getElementById('input-id').value = '';
        document.getElementById('input-date').value = '';
        document.getElementById('input-broadcast-no').value = '';
        document.getElementById('input-morning-music').value = '';
        document.getElementById('input-morning-corner').value = '';
        document.getElementById('input-intro').value = '';
        document.getElementById('input-music').value = '';
        document.getElementById('input-trivia-title').value = '';
        document.getElementById('input-trivia-content').value = '';
        document.getElementById('input-closing').value = '';
    }


    // ----------------------------------------------------
    // 6. ãƒ‡ãƒ¼ã‚¿ä¿å­˜å‡¦ç† (è¿½åŠ ãƒ»æ›´æ–°ã‚’å…¼ã­ã‚‹)
    // ----------------------------------------------------
    addDataButton.addEventListener('click', saveBroadcastData);

    function saveBroadcastData() {
        const id = inputId.value ? parseInt(inputId.value) : null;
        const date = inputDate.value.trim();
        const broadcastNo = parseInt(inputBroadcastNo.value.trim());
        const morningMusic = inputMorningMusic.value.trim();
        const morningCorner = inputMorningCorner.value.trim();
        const intro = inputIntro.value.trim();
        const musicString = inputMusic.value.trim();
        const triviaTitle = inputTriviaTitle.value.trim();
        const triviaContentText = inputTriviaContent.value.trim();
        const closing = inputClosing.value.trim();

        if (!date || isNaN(broadcastNo) || !intro || !triviaTitle || !closing || !musicString || !morningMusic) {
            alert("æ—¥ä»˜ã€æ”¾é€ç•ªå·ã€æœã®æ›²ç›®ã€æ˜¼ã®ã‚»ãƒªãƒ•ã€é›‘å­¦ã‚¿ã‚¤ãƒˆãƒ«ã€ç· ã‚ã®ã‚»ãƒªãƒ•ã€æ˜¼ã®æ›²ç›®ã¯å…¨ã¦å¿…é ˆå…¥åŠ›ã§ã™ã€‚");
            return;
        }

        // æ›²ç›®ãƒªã‚¹ãƒˆã‚’ã€Œ|ã€ã§åˆ†å‰²ã—ã€æ•´å½¢
        const musicArray = musicString.split('|').map(m => m.trim()).filter(m => m.length > 0);
        
        // é›‘å­¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯ä¸€ã¤ã«çµ±ä¸€ (UIç°¡ç•¥åŒ–ã®ãŸã‚)
        const triviaContentArray = [{ 
            title: triviaTitle, 
            text: triviaContentText || "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒæœªå…¥åŠ›ã§ã™ã€‚" 
        }];

        const newData = {
            id: id,
            date: date,
            broadcastNo: broadcastNo,
            morning: { 
                title: "æœã®æ”¾é€", 
                music: morningMusic, 
                corner: morningCorner 
            },
            lunch: {
                title: "æ˜¼ã®æ”¾é€",
                music: musicArray,
                intro: intro,
                triviaTitle: triviaTitle,
                triviaContent: triviaContentArray,
                closing: closing
            }
        };

        if (id) {
            // æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°
            const index = currentBroadcastData.findIndex(d => d.id === id);
            if (index !== -1) {
                currentBroadcastData[index] = newData;
                alert(`æ”¾é€ç•ªå· ${broadcastNo} (${date}) ã®ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸï¼`);
            }
        } else {
            // æ–°è¦ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ 
            const newId = currentBroadcastData.length > 0 
                ? Math.max(...currentBroadcastData.map(d => d.id)) + 1
                : 1;
            newData.id = newId;
            currentBroadcastData.push(newData);
            alert(`æ”¾é€ç•ªå· ${broadcastNo} (${date}) ã®ãƒ‡ãƒ¼ã‚¿ãŒæ–°è¦è¿½åŠ ã•ã‚Œã¾ã—ãŸï¼`);
        }

        saveData();
        renderSelector();
        closeEditor();
    }


    // ----------------------------------------------------
    // 7. æ—¥ä»˜é¸æŠãƒœã‚¿ãƒ³ã®ç”Ÿæˆ
    // ----------------------------------------------------
    function renderSelector() {
        // æ—¢å­˜ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªã‚¢ï¼ˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã¯æ®‹ã™ï¼‰
        const existingButtons = selector.querySelectorAll('button:not(#clear-selection-button):not(#download-button):not(#toggle-editor-button):not(#add-data-button)');
        existingButtons.forEach(btn => btn.remove());

        // æ”¾é€ç•ªå·é †ã«ä¸¦ã¹æ›¿ãˆã‚‹
        const sortedData = [...currentBroadcastData].sort((a, b) => a.broadcastNo - b.broadcastNo);

        sortedData.forEach(data => {
            const button = document.createElement('button');
            button.className = "w-full text-left p-3 my-1 rounded-lg transition duration-150 ease-in-out bg-white hover:bg-blue-100 border border-gray-200 shadow-sm flex justify-between items-center group";
            
            button.innerHTML = `
                <div>
                    <div class="font-bold text-gray-800">${data.date}</div>
                    <div class="text-sm text-blue-500">æ”¾é€ç•ªå· ${data.broadcastNo}</div>
                </div>
                <div class="flex items-center space-x-2">
                    <!-- ç·¨é›†ãƒœã‚¿ãƒ³ -->
                    <button class="edit-button p-2 text-sm bg-purple-100 text-purple-600 rounded-md opacity-0 group-hover:opacity-100 transition duration-300 hover:bg-purple-200 shadow-sm"
                            data-id="${data.id}"
                            onclick="event.stopPropagation(); loadEditorForDataById(${data.id});">
                        ç·¨é›†
                    </button>
                    <!-- è©³ç´°è¡¨ç¤ºãƒœã‚¿ãƒ³ï¼ˆã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã¯è¦ªãƒœã‚¿ãƒ³ã«ï¼‰ -->
                </div>
            `;
            // è©³ç´°è¡¨ç¤ºã®ãƒ¡ã‚¤ãƒ³ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            button.onclick = () => selectScript(data);
            selector.appendChild(button);
        });
    }
    
    // ç·¨é›†ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
    window.loadEditorForDataById = function(id) {
        const dataToEdit = currentBroadcastData.find(d => d.id === id);
        if (dataToEdit) {
            selectScript(dataToEdit); // è©³ç´°ã‚’è¡¨ç¤º
            openEditor('edit', dataToEdit); // ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ­ãƒ¼ãƒ‰
        } else {
            alert("ç·¨é›†å¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚");
        }
    }


    // ----------------------------------------------------
    // 8. é¸æŠã•ã‚ŒãŸåŸç¨¿ã®è©³ç´°è¡¨ç¤º
    // ----------------------------------------------------
    function selectScript(data) {
        if (initialMessage) initialMessage.classList.add('hidden');
        maskControls.classList.remove('hidden');

        let existingContent = document.getElementById('current-script-display');
        if (existingContent) {
            existingContent.remove();
        }

        const newContent = document.createElement('div');
        newContent.id = 'current-script-display';
        newContent.innerHTML = renderScriptHTML(data);
        
        detailArea.appendChild(newContent); 

        isMasked = false;
        updateMaskState();
    }
    
    // ----------------------------------------------------
    // 9. ãƒã‚¹ã‚¯æ©Ÿèƒ½ã®åˆ‡ã‚Šæ›¿ãˆ
    // ----------------------------------------------------
    maskButton.addEventListener('click', toggleMask);

    function toggleMask() {
        isMasked = !isMasked;
        updateMaskState();
    }

    function updateMaskState() {
        const maskElements = document.querySelectorAll('.masked-content');
        const button = document.getElementById('mask-button');
        
        if (isMasked) {
            maskElements.forEach(el => {
                if (!el.querySelector('.mask-overlay')) {
                    const maskOverlay = document.createElement('div');
                    maskOverlay.className = 'mask-overlay';
                    maskOverlay.innerHTML = '<span class="text-3xl font-extrabold select-none">ğŸ”’ CONTENTS MASKED ğŸ”’</span>';
                    el.appendChild(maskOverlay);
                }
            });
            button.textContent = 'ğŸ”“ å†…å®¹ã‚’è¡¨ç¤º (ãƒã‚¹ã‚¯OFF)';
            button.classList.remove('bg-red-500', 'hover:bg-red-600');
            button.classList.add('bg-green-500', 'hover:bg-green-600');
        } else {
            maskElements.forEach(el => {
                const overlay = el.querySelector('.mask-overlay');
                if (overlay) {
                    el.removeChild(overlay);
                }
            });
            button.textContent = 'ğŸ”’ å†…å®¹ã‚’éš ã™ (ãƒã‚¹ã‚¯ON)';
            button.classList.remove('bg-green-500', 'hover:bg-green-600');
            button.classList.add('bg-red-500', 'hover:bg-red-600');
        }
    }
    
    // ----------------------------------------------------
    // 10. è©³ç´°è¡¨ç¤ºã®ã‚¯ãƒªã‚¢æ©Ÿèƒ½
    // ----------------------------------------------------
    clearButton.addEventListener('click', clearSelection);

    function clearSelection() {
        let existingContent = document.getElementById('current-script-display');
        if (existingContent) {
            existingContent.remove();
        }

        maskControls.classList.add('hidden');
        initialMessage.classList.remove('hidden');
        isMasked = false;
        updateMaskState(); 
        
        // ã‚¯ãƒªã‚¢æ™‚ã«ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã‚‚é–‰ã˜ã‚‹
        closeEditor();
    }

    // ----------------------------------------------------
    // 11. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
    // ----------------------------------------------------
    downloadButton.addEventListener('click', downloadCurrentFile);

    function downloadCurrentFile() {
        // ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿é…åˆ—ã‚’JSONæ–‡å­—åˆ—ã«å¤‰æ›
        const currentDataJsonString = JSON.stringify(currentBroadcastData, null, 4);

        // HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„å…¨ä½“ã‚’å–å¾—
        let htmlContent = document.documentElement.outerHTML;

        // æ­£è¦è¡¨ç¾ã‚’ä½¿ã£ã¦ã€å…ƒã® `initialBroadcastData` ã®å®šç¾©éƒ¨åˆ†ã‚’ã€
        // ç¾åœ¨ã® `currentDataJsonString` ã«ç½®ãæ›ãˆã‚‹
        // ([\s\S]*?) ã¯éè²ªæ¬²ãƒãƒƒãƒã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ–ãƒ­ãƒƒã‚¯å…¨ä½“ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã™ã‚‹
        const regex = /const initialBroadcastData = \[\s*([\s\S]*?)\s*\];/;
        
        // ç½®ãæ›ãˆç”¨ã®æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ–ãƒ­ãƒƒã‚¯
        // JSON.stringifyã®çµæœã‚’ç›´æ¥åŸ‹ã‚è¾¼ã¿ã€æœ«å°¾ã«ã‚»ãƒŸã‚³ãƒ­ãƒ³ã‚’ä»˜ã‘ã‚‹
        const newCodeBlock = `const initialBroadcastData = ${currentDataJsonString};`;

        // æ­£è¦è¡¨ç¾ã«ãƒãƒƒãƒã—ãŸéƒ¨åˆ†ã‚’æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ–ãƒ­ãƒƒã‚¯ã«ç½®ãæ›ãˆã‚‹
        htmlContent = htmlContent.replace(regex, newCodeBlock);
        
        // Blobã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
        const blob = new Blob([htmlContent], { type: 'text/html' });
        
        // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'broadcast_manager.html';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        alert("æœ€æ–°ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸã€‚GitHubã«ã‚³ãƒŸãƒƒãƒˆã—ã¦æ›´æ–°ã—ã¦ãã ã•ã„ï¼");
        console.log("æœ€æ–°ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã—ãŸã€‚");
    }


    // ----------------------------------------------------
    // 12. è©³ç´°è¡¨ç¤ºã‚¨ãƒªã‚¢ã®HTMLç”Ÿæˆ
    // ----------------------------------------------------
    function renderScriptHTML(data) {
        
        const mainTitle = `æ”¾é€ç•ªå· ${data.broadcastNo} - ${data.date}`;
        
        // æœã®æ”¾é€éƒ¨åˆ†ã®HTML (ã“ã“ã¯ãƒã‚¹ã‚¯ã‚’é©ç”¨ã—ãªã„)
        const morningScript = `
            <div class="mb-8 p-6 border-l-4 border-orange-500 bg-orange-50 rounded-lg shadow-inner script-box">
                <h3 class="text-2xl font-bold text-orange-600 mb-4">${data.morning.title} (æ”¾é€ç•ªå· ${data.broadcastNo})</h3>
                <p class="text-sm font-bold text-red-500 mb-4">ã€ã‚»ãƒªãƒ•ãƒ»ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ä¸€åˆ‡ãªã—ã€‘</p>
                <div class="ml-4 space-y-2">
                    <p><span class="font-bold text-gray-700">1æ›²ç›®ï¼š</span>${data.morning.music}</p>
                    <p><span class="font-bold text-gray-700">ã‚³ãƒ¼ãƒŠãƒ¼ï¼š</span>${data.morning.corner}</p>
                </div>
            </div>
        `;

        // æ˜¼ã®æ”¾é€ï¼ˆå…±é€šæ§‹æˆï¼‰
        // é›‘å­¦ã¯é…åˆ—ã ãŒã€ãƒ•ã‚©ãƒ¼ãƒ ã§1ã¤ã«ã¾ã¨ã‚ãŸã®ã§ã€ã“ã“ã§ã¯å…¨é …ç›®ã‚’HTMLåŒ–
        let triviaItems = data.lunch.triviaContent.map(item => `
            <h4 class="font-bold mt-3 text-lg text-blue-700">${item.title}</h4>
            <p class="mb-2">${item.text}</p>
        `).join('');
        
        // æ›²ç›®ãƒªã‚¹ãƒˆã®ç”Ÿæˆ 
        const musicListHtml = data.lunch.music.map((song, index) => {
            // æ›²ç›®ã®è¡¨ç¤ºå½¢å¼ã‚’çµ±ä¸€ (ã€Œ1æ›²ç›®ï¼šã€ãªã©ã®ç•ªå·ã¯ãƒ‡ãƒ¼ã‚¿è‡ªä½“ã«å«ã¾ã‚Œãªã„ã‚ˆã†ã«ã—ãŸãŸã‚ã€ã“ã“ã§ã¯ã‚·ãƒ³ãƒ—ãƒ«ã«)
            return `<li class="my-1">ã€æ›²ç›®ã€‘<span class="font-bold">${song}</span></li>`;
        }).join('');

        const lunchScript = `
            <div class="p-8 border-l-4 border-blue-600 bg-blue-50 rounded-lg shadow-inner script-box">
                <h3 class="text-2xl font-bold text-blue-800 mb-4">${data.lunch.title} (æ”¾é€ç•ªå· ${data.broadcastNo})</h3>
                
                <!-- å°å…¥ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ -->
                <div class="bg-yellow-100 p-4 rounded-md mb-6 relative script-box">
                    <p class="font-bold text-xl text-yellow-800">ğŸ—£ï¸ å°å…¥ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ (CDéŸ³é‡0ç¢ºèªå¾Œ)</p>
                    <div class="masked-content p-2 bg-yellow-100 rounded-md mt-2">
                         <p class="text-gray-700">${data.lunch.intro}</p>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">â€»iPadã®èª­ã¿ä¸Šã’æ©Ÿèƒ½ã§ã“ã®ã‚»ãƒªãƒ•ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>
                </div>

                <div class="mb-6">
                    <p class="font-bold text-xl text-green-700 mb-2">ğŸ¶ æœ¬æ—¥ã®æ›²ç›®</p>
                    <ul class="list-disc list-inside ml-4 text-gray-700">
                        ${musicListHtml}
                    </ul>
                </div>
                
                <!-- é›‘å­¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
                <div class="bg-gray-100 p-4 rounded-md mb-6 relative script-box">
                    <p class="font-bold text-xl text-gray-800 mb-2">ğŸ“ ${data.lunch.triviaTitle}</p>
                    <div class="masked-content p-2 bg-gray-100 rounded-md mt-2">
                        <div class="text-gray-700">${triviaItems}</div>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">â€»iPadã®èª­ã¿ä¸Šã’æ©Ÿèƒ½ã§ã“ã®é›‘å­¦ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>
                </div>
                
                <!-- ç· ã‚ã®ã‚»ãƒªãƒ• -->
                <div class="bg-red-100 p-4 rounded-md relative script-box mt-6">
                    <p class="font-bold text-xl text-red-700">ğŸ‘‹ ç· ã‚ã®ã‚»ãƒªãƒ• (CDçµ‚äº†å¾Œ)</p>
                    <div class="masked-content p-2 bg-red-100 rounded-md mt-2">
                         <p class="text-gray-700">${data.lunch.closing}</p>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">â€»iPadã®èª­ã¿ä¸Šã’æ©Ÿèƒ½ã§ã“ã®ã‚»ãƒªãƒ•ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>
                </div>

            </div>
        `;

        return `
            <h2 class="text-3xl font-extrabold mb-6 pb-3 border-b-2 text-gray-800">
                ${mainTitle}
            </h2>
            <div class="space-y-10">
                ${morningScript}
                ${lunchScript}
            </div>
        `;
    }

    // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–
    window.onload = () => {
        loadData(); // localStorageã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
        renderSelector(); // ã‚»ãƒ¬ã‚¯ã‚¿ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    };

</script>
</body>
</html>
