<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>çµ¦é£Ÿæ”¾é€ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆçµ±åˆç‰ˆï¼‰</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

<!-- ======================== -->
<!-- å·¦ï¼šæ—¥ä»˜ & æ”¾é€ç•ªå· é¸æŠ -->
<!-- ======================== -->
<div class="min-h-screen flex flex-col md:flex-row">

    <!-- å·¦å´ãƒªã‚¹ãƒˆ -->
    <div class="w-full md:w-1/3 p-6 bg-white shadow-lg">
        <h1 class="text-3xl font-bold mb-4">çµ¦é£Ÿæ”¾é€ãƒ‡ãƒ¼ã‚¿</h1>

        <button id="add-new-script"
            class="no-print bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow mb-4">
            â• æ–°ã—ã„æ”¾é€ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
        </button>

        <div id="load-message" class="mb-4 text-gray-600"></div>

        <div id="date-list" class="space-y-2"></div>
    </div>

    <!-- ======================== -->
    <!-- å³ï¼šæ”¾é€å†…å®¹ or ç·¨é›†ç”»é¢ -->
    <!-- ======================== -->
    <div class="w-full md:w-2/3 p-6" id="right-panel">
        <p class="text-gray-500">å·¦ã®ä¸€è¦§ã‹ã‚‰æ”¾é€æ—¥ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
    </div>

</div>

<script>

// ==========================
// åˆæœŸãƒ‡ãƒ¼ã‚¿ï¼ˆæ”¾é€ç•ªå·ä»˜ãï¼‰
// ==========================
const initialBroadcastData = [
    {
        date: "2025-01-10",
        type: 1,  // â† æ”¾é€ç•ªå·ï¼‘
        title: "é€šå¸¸çµ¦é£Ÿæ”¾é€",
        lunch: {
            intro: "ã“ã‚“ã«ã¡ã¯ã€çµ¦é£Ÿæ”¾é€ã§ã™ã€‚",
            menu: ["ã”ã¯ã‚“", "å‘³å™Œæ±", "ç„¼ãé­š"],
            music: ["é¢¨ã«ãªã‚‹ â€“ ã¤ã˜ã‚ã‚„ã®"],
            triviaTitle: "ä»Šæ—¥ã®é›‘å­¦",
            triviaContent: [
                { title: "ãƒ•ãƒ©ãƒ³ã‚¹ã®çµ¦é£Ÿ", text: "çµ¦é£Ÿã®æ™‚é–“ãŒé•·ã„ã“ã¨ã§æœ‰åã€‚" }
            ],
            closing: "ãã‚Œã§ã¯æ¥½ã—ã„çµ¦é£Ÿã®æ™‚é–“ã‚’éã”ã—ã¾ã—ã‚‡ã†ã€‚"
        }
    },
    {
        date: "2025-01-11",
        type: 2,  // â† æ”¾é€ç•ªå·ï¼’
        title: "é›‘å­¦æ”¾é€",
        lunch: {
            intro: "ä»Šæ—¥ã¯ç‰¹åˆ¥ãªé›‘å­¦ã®æ—¥ã§ã™ã€‚",
            menu: ["ã‚«ãƒ¬ãƒ¼", "ã‚µãƒ©ãƒ€"],
            music: ["ãƒˆãƒˆãƒ­ â€“ ã•ã‚“ã½"],
            triviaTitle: "ä¸–ç•Œã®ã‚¯ãƒªã‚¹ãƒã‚¹",
            triviaContent: [
                { title: "ãƒ‰ã‚¤ãƒ„", text: "ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ç”±æ¥â€¦" }
            ],
            closing: "ã¾ãŸæ¬¡å›ã®é›‘å­¦ã‚‚ãŠæ¥½ã—ã¿ã«ï¼"
        }
    }
];

// ==========================
// ãƒ‡ãƒ¼ã‚¿ä¿å­˜
// ==========================
let broadcastData = JSON.parse(localStorage.getItem("broadcastData")) || initialBroadcastData;

function saveData() {
    localStorage.setItem("broadcastData", JSON.stringify(broadcastData));
}

// ==========================
// æ—¥ä»˜ä¸€è¦§ã‚’è¡¨ç¤º
// ==========================
function renderDateList() {
    const dateListDiv = document.getElementById("date-list");
    dateListDiv.innerHTML = "";

    broadcastData.forEach(item => {
        const btn = document.createElement("button");
        btn.className = "w-full text-left p-3 bg-gray-200 hover:bg-gray-300 rounded";
        btn.textContent = `${item.date}ï¼ˆæ”¾é€ç•ªå·${item.type}ï¼‰`;
        btn.onclick = () => selectScript(item);
        dateListDiv.appendChild(btn);
    });
}

renderDateList();

// ==========================
// é¸æŠã—ãŸæ”¾é€ã‚’è¡¨ç¤º
// ==========================
function selectScript(data) {
    const area = document.getElementById("right-panel");

    area.innerHTML = `
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-2xl font-bold">${data.date}ï¼ˆæ”¾é€ç•ªå· ${data.type}ï¼‰</h2>

            <button id="edit-button"
                class="no-print bg-green-600 hover:bg-green-700 text-white py-1 px-3 rounded">
                âœï¸ ç·¨é›†
            </button>
        </div>

        <h3 class="text-xl font-bold mt-4">ã‚¿ã‚¤ãƒˆãƒ«</h3>
        <p>${data.title}</p>

        <h3 class="text-xl font-bold mt-4">å°å…¥</h3>
        <p>${data.lunch.intro}</p>

        <h3 class="text-xl font-bold mt-4">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h3>
        <ul>${data.lunch.menu.map(v => `<li>ãƒ»${v}</li>`).join("")}</ul>

        <h3 class="text-xl font-bold mt-4">æ›²ç›®</h3>
        <ul>${data.lunch.music.map(v => `<li>â™ª ${v}</li>`).join("")}</ul>

        <h3 class="text-xl font-bold mt-4">${data.lunch.triviaTitle}</h3>
        <ul>${data.lunch.triviaContent.map(v => `<li><strong>${v.title}</strong>ï¼š${v.text}</li>`).join("")}</ul>

        <h3 class="text-xl font-bold mt-4">ç· ã‚</h3>
        <p>${data.lunch.closing}</p>
    `;

    document.getElementById("edit-button").onclick = () => renderEditor(data);
}

// ==========================
// ç·¨é›†ãƒ¢ãƒ¼ãƒ‰
// ==========================
function renderEditor(data) {
    const area = document.getElementById("right-panel");

    area.innerHTML = `
        <h2 class="text-2xl font-bold mb-4">ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼š${data.date}</h2>

        <label class="font-bold">æ”¾é€ç•ªå·ï¼ˆ1ã€œ3ï¼‰</label>
        <input id="type" type="number" min="1" max="3" class="w-full border p-2 mb-4" value="${data.type}">

        <label class="font-bold">ã‚¿ã‚¤ãƒˆãƒ«</label>
        <input id="title" class="w-full border p-2 mb-4" value="${data.title}">

        <label class="font-bold">å°å…¥ã‚¢ãƒŠã‚¦ãƒ³ã‚¹</label>
        <textarea id="intro" class="w-full border p-2 mb-4">${data.lunch.intro}</textarea>

        <label class="font-bold">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆæ”¹è¡ŒåŒºåˆ‡ã‚Šï¼‰</label>
        <textarea id="menu" class="w-full border p-2 mb-4">${data.lunch.menu.join("\n")}</textarea>

        <label class="font-bold">æ›²ç›®ï¼ˆæ”¹è¡ŒåŒºåˆ‡ã‚Šï¼‰</label>
        <textarea id="music" class="w-full border p-2 mb-4">${data.lunch.music.join("\n")}</textarea>

        <label class="font-bold">é›‘å­¦ã‚¿ã‚¤ãƒˆãƒ«</label>
        <input id="triviaTitle" class="w-full border p-2 mb-4" value="${data.lunch.triviaTitle}">

        <label class="font-bold">é›‘å­¦æœ¬æ–‡ï¼ˆã‚¿ã‚¤ãƒˆãƒ«:ãƒ†ã‚­ã‚¹ãƒˆ ã®å½¢å¼ã€æ”¹è¡ŒåŒºåˆ‡ã‚Šï¼‰</label>
        <textarea id="triviaContent" class="w-full border p-2 mb-4">${data.lunch.triviaContent
            .map(v => `${v.title}:${v.text}`).join("\n")}</textarea>

        <label class="font-bold">ç· ã‚ã®ã‚»ãƒªãƒ•</label>
        <textarea id="closing" class="w-full border p-2 mb-4">${data.lunch.closing}</textarea>

        <button id="save"
            class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">
            ğŸ’¾ ä¿å­˜
        </button>
    `;

    document.getElementById("save").onclick = () => saveEdit(data);
}

// ==========================
// ç·¨é›†ä¿å­˜
// ==========================
function saveEdit(data) {
    data.type = Number(document.getElementById("type").value);
    data.title = document.getElementById("title").value;

    data.lunch.intro = document.getElementById("intro").value;

    data.lunch.menu = document.getElementById("menu").value.split("\n").filter(v => v);
    data.lunch.music = document.getElementById("music").value.split("\n").filter(v => v);

    data.lunch.triviaTitle = document.getElementById("triviaTitle").value;
    data.lunch.triviaContent = document.getElementById("triviaContent").value.split("\n")
        .map(line => {
            const [title, ...rest] = line.split(":");
            return { title, text: rest.join(":") };
        });

    data.lunch.closing = document.getElementById("closing").value;

    saveData();
    renderDateList();
    selectScript(data);
}

</script>

</body>
</html>
